---
title: "Visualization of Entomological Surveillance data with Ovitraps"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Visualization of Entomological Surveillance data with Ovitraps}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, echo=FALSE}
library(deneggs)
```


## Indicadores de la Vigilancia Entomológica con Ovitrampas

En la [Guia metodológica para la vigilancia entomologica con ovitrampas](https://www.gob.mx/cms/uploads/attachment/file/598092/Guia_Metodologica_para_Vigilancia_Entomologica_con_Ovitrampas_compressed.pdf) del Centro Nacional de Programas Preventivos y Control de Enfermedades (CENAPRECE) se recomiendan cinco indicadores para el análisis y toma de desiciones en el programa de prevención y control del dengue. 

  1) Porcentaje de Ovitrampa Positivas (IPO): $$\frac{Ovitrampas Positivas}{Ovitrampas Revisadas} * 100$$

  2) Porcentaje de Manzanas Positivas (MP): $$\frac{Manzanas Positivas}{Manzanas Revisadas} * 100$$
  
  3) Promedio de Huevos por Ovitrampa (PHO): $$\frac{Total de Huevos}{Número de Ovitrampas Positiva}$$

  4) Promedio de Huevos por Manzana (PHM): $$\frac{Total de Huevos por Manzana}{Manzanas Revisadas}$$

  5) Promedio de Huevos por Manzanas Positivas (PHMP): $$\frac{Total de Huevos por Manzana}{Manzanas Positivas}$$


El paquete **deneggs** calcula los indicadores de prevalencia y abundancia para los dos niveles de resolución espacial (ovitrampas (casa) o para las manzanas). Estos indicadores son obtenidos a través de la función **ovitraps_occupancy_abundancy**. Las función tienen dos argumentos, **path_ovitraps** y **scale**, la primera es para definir la ruta de la carpeta donde están guardados los archivos de lecturas de ovitrampas con extensión txt y el argumento **scale** es para definir la resolución espacial o la unidad de análisis, la cual tiene solo dos opciones, manzana (blocks) u ovitrampa (ovitraps).

El resultado de la función **ovitraps_occupancy_abundancy** es un gráfico bivariado de dos ejes interactivo de todas las localidades con ovitrampas del estado. En en el eje x se representa el tiempo en escala de semanas epidemiológicas, en el eje y primario (eje izquierdo) se gráfica el porcentaje de ovitrampas positivas o el porcentaje de manzanas positivas & en el eje y (eje derecho) se gráfica la abundancia de huevos en ovitrampas positivas o la abundancia de huevos en manzanas positivas.



## Indicadores por Ovitrampa o Casa
```{r ind_, warning=FALSE, message=FALSE, out.width = '110%', out.height= '110%'}
path <- "/Users/fdzul/Dropbox/CENAPRECE/2024/31_yucatan"
deneggs::ovitraps_occupancy_abundancy(path_ovitraps  = path,
                                      scale = "ovitraps")
```


## Indicadores por Manzana

```{r,  warning=FALSE, message=FALSE, out.width = '110%', out.height= '110%'}
path <- "/Users/fdzul/Dropbox/CENAPRECE/2024/31_yucatan"
deneggs::ovitraps_occupancy_abundancy(path_ovitraps = path,
                                      scale = "blocks")
```


## Mapas la Vigilancia Entomológica con Ovitrampas

El paquete **deneggs** tiene funciones adicionales para mapear


## Mapa de la Abundancia de Huevos
```{r ovitraps, warning=FALSE, message=FALSE}
#| warning: False
#| message: False
#| echo: true
#| output: true
#| out.width: "100%"

# Paso 1. definir la ruta de la carpeta
path_vect <- "/Users/fdzul/Dropbox/CENAPRECE/2024/31_yucatan"
path_coord <- paste(path_vect, "DescargaOvitrampasMesFco.txt", sep = "/")

# Paso 2. ge
deneggs::eggs_risk(path_vect = path_vect,
                   path_coord = path_coord,
                   weeks = 30,
                   locality = "Ticul",
                   risk = FALSE)
```


## Mapa del Riesgo Entomológico de Huevos

```{r riesgo_entomologicos}
#| warning: False
#| message: False
#| echo: true
#| output: true
#| out.width: "100%"
path_vect <- "/Users/fdzul/Dropbox/CENAPRECE/2024/31_yucatan"
path_coord <- paste(path_vect, "DescargaOvitrampasMesFco.txt", sep = "/")

deneggs::eggs_risk(path_vect = path_vect,
                   path_coord = path_coord,
                   weeks = 30,
                   locality = "Ticul",
                   risk = TRUE)
```


